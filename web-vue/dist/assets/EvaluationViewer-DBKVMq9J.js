import{d as S,u as N,r as p,e as T,c as e,s as u,a as t,g as r,A as z,H as B,I as M,t as i,F as c,x as v,m as P,h as x,D as H,v as K,o,n as L,k as w}from"./index-CqbccW_d.js";import{D as O}from"./DashboardHeader-D_eb9y5d.js";import{r as U}from"./ChartBarIcon-DoP_MdiH.js";import{r as b}from"./CheckIcon-A7RKCyXW.js";const q={class:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100"},G={class:"container mx-auto px-4 py-6"},J={class:"mb-6"},Q={class:"card p-4"},R={class:"flex items-center space-x-4"},W={class:"flex-1"},X={class:"flex space-x-2 pt-6"},Y=["disabled"],Z={key:0},tt={key:1},st={key:0,class:"mt-2 text-sm text-red-600"},et={key:0,class:"space-y-6"},ot={class:"card"},lt={class:"border-b border-gray-200"},at={class:"-mb-px flex space-x-8"},it=["onClick"],nt={class:"p-6"},dt={key:0,class:"space-y-4"},rt={class:"space-y-6"},ut={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},ct={class:"space-y-4"},vt={class:"p-3 bg-blue-50 rounded-md border"},xt={class:"p-3 bg-green-50 rounded-md border max-h-32 overflow-y-auto"},mt={class:"space-y-4"},gt={class:"grid grid-cols-2 gap-4"},pt={class:"p-3 bg-gray-50 rounded-md"},_t={class:"text-lg font-semibold text-gray-800"},yt={class:"p-3 bg-purple-50 rounded-md"},bt={class:"text-lg font-semibold text-purple-600"},ft={class:"p-3 bg-yellow-50 rounded-md border max-h-32 overflow-y-auto text-sm font-mono"},ht={key:1,class:"space-y-4"},wt={class:"space-y-6"},kt={class:"p-6 bg-gradient-to-r from-blue-50 to-indigo-50 rounded-lg border border-blue-200"},jt={class:"flex items-center justify-between mb-4"},Dt={class:"text-3xl font-bold text-blue-600"},$t={class:"mb-4"},Ct={class:"w-full bg-gray-200 rounded-full h-3"},It={class:"text-sm text-gray-700 bg-white p-3 rounded-md border"},Et={class:"p-4 bg-pink-50 rounded-lg border border-pink-200"},Vt={key:0},Ft={class:"grid grid-cols-2 md:grid-cols-4 gap-3"},At={class:"text-2xl mb-1"},St={class:"text-xs text-gray-600 capitalize"},Nt={class:"text-sm font-medium"},Tt={key:1,class:"text-sm text-gray-500 text-center py-4"},zt={class:"flex flex-wrap gap-2"},Bt={key:0,class:"text-gray-500 text-sm"},Mt={class:"space-y-2"},Pt={class:"flex items-start space-x-2"},Ht={class:"w-5 h-5 bg-yellow-500 rounded-full flex items-center justify-center text-white text-xs font-bold flex-shrink-0 mt-0.5"},Kt={key:0,class:"text-center py-8 text-gray-500"},Lt={class:"space-y-2"},Ot={class:"flex items-start space-x-2"},Ut={key:0,class:"text-center py-8 text-gray-500"},qt={key:2,class:"space-y-4"},Gt={class:"space-y-6"},Jt={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},Qt={class:"p-4 bg-teal-50 rounded-lg"},Rt={class:"text-2xl font-bold text-teal-600"},Wt={class:"p-4 bg-orange-50 rounded-lg"},Xt={class:"text-2xl font-bold text-orange-600"},Yt={class:"p-4 bg-purple-50 rounded-lg"},Zt={class:"text-2xl font-bold text-purple-600"},ts={key:0},ss={class:"flex flex-wrap gap-2"},es={class:"space-y-3"},os={class:"flex justify-between items-start mb-2"},ls={class:"text-sm font-medium text-gray-700"},as={class:"px-2 py-1 bg-teal-100 text-teal-800 text-xs rounded-full"},is={class:"text-gray-600 text-sm"},ns={key:0},ds={key:0,class:"text-center py-8 text-gray-500"},rs={key:1,class:"text-center py-12"},us={key:0,class:"fixed inset-0 z-50 overflow-y-auto"},cs={class:"flex min-h-full items-center justify-center p-4"},vs={class:"relative w-full max-w-4xl bg-white rounded-xl shadow-2xl"},xs={class:"p-6"},ms={class:"flex items-center justify-between mb-4"},gs={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},ps={class:"space-y-4"},_s={class:"space-y-2 text-sm text-gray-600"},ys={class:"flex items-center space-x-2"},bs={class:"flex items-center space-x-2"},fs={class:"flex items-center space-x-2"},hs={class:"flex items-center space-x-2"},ws={class:"flex items-center space-x-2"},ks="http://localhost:5000/api",Es=S({__name:"EvaluationViewer",setup(js){const k=N(),m=p(""),l=p(null),_=p(!1),g=p(""),y=p("context"),h=p(!1),F=[{id:"context",name:"评估上下文"},{id:"results",name:"评估结果"},{id:"associations",name:"关联创建"}],j=n=>!n&&n!==0?"未知":n<.001?"<1ms":n<1?`${(n*1e3).toFixed(1)}ms`:`${n.toFixed(3)}s`,A=n=>({joy:"😊",sadness:"😢",anger:"😠",fear:"😨",surprise:"😮",disgust:"🤢",positive:"😊",negative:"😔",neutral:"😐",happy:"😄",excited:"🤩",calm:"😌",confused:"😕",frustrated:"😤"})[n.toLowerCase()]||"😐",D=async()=>{if(!m.value.trim()){g.value="请输入会话ID";return}_.value=!0,g.value="";try{const n=await fetch(`${ks}/session/${m.value}/evaluation`);if(!n.ok){const f=await n.json();throw new Error(f.error||`HTTP ${n.status}`)}const s=await n.json();l.value=s,k.add({type:"success",title:"评估数据加载成功",message:`已加载会话 ${m.value} 的评估数据`})}catch(n){g.value=n.message||"加载失败",l.value=null,k.add({type:"error",title:"加载失败",message:g.value})}finally{_.value=!1}};return T(()=>{console.log("EvaluationViewer mounted")}),(n,s)=>{var f,$,C,I,E,V;return o(),e("div",q,[u(O),t("main",G,[s[30]||(s[30]=t("div",{class:"mb-6"},[t("h1",{class:"text-2xl font-bold text-gray-900 mb-2"},"异步评估展示"),t("p",{class:"text-gray-600"},"监控异步评估过程和结果，了解系统如何评价对话质量")],-1)),t("div",J,[t("div",Q,[t("div",R,[t("div",W,[s[3]||(s[3]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"选择会话ID",-1)),z(t("input",{"onUpdate:modelValue":s[0]||(s[0]=a=>m.value=a),onKeyup:M(D,["enter"]),type:"text",placeholder:"输入会话ID (例如: user123_20250123_140500)",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500"},null,544),[[B,m.value]])]),t("div",X,[t("button",{onClick:D,disabled:!m.value||_.value,class:"px-4 py-2 bg-primary-500 text-white rounded-md hover:bg-primary-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors"},[_.value?(o(),e("span",Z,"加载中...")):(o(),e("span",tt,"查看评估"))],8,Y)])]),g.value?(o(),e("div",st,i(g.value),1)):r("",!0)])]),l.value?(o(),e("div",et,[t("div",ot,[t("div",lt,[t("nav",at,[(o(),e(c,null,v(F,a=>t("button",{key:a.id,onClick:d=>y.value=a.id,class:L(["py-2 px-1 border-b-2 font-medium text-sm",y.value===a.id?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"])},i(a.name),11,it)),64))])]),t("div",nt,[y.value==="context"?(o(),e("div",dt,[s[10]||(s[10]=t("h3",{class:"text-lg font-medium text-gray-900"},"评估上下文构建",-1)),t("div",rt,[t("div",ut,[t("div",ct,[t("div",null,[s[4]||(s[4]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"用户输入",-1)),t("div",vt,i(l.value.evaluation_context.user_input||"暂无数据"),1)]),t("div",null,[s[5]||(s[5]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"AI回复",-1)),t("div",xt,i(l.value.evaluation_context.assistant_response||"暂无数据"),1)])]),t("div",mt,[t("div",null,[s[8]||(s[8]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"评估配置",-1)),t("div",gt,[t("div",pt,[s[6]||(s[6]=t("div",{class:"text-sm text-gray-600"},"使用模型",-1)),t("div",_t,i(l.value.evaluation_context.model_used||"未知"),1)]),t("div",yt,[s[7]||(s[7]=t("div",{class:"text-sm text-gray-600"},"评估耗时",-1)),t("div",bt,i(j(l.value.evaluation_context.evaluation_time)),1)])])]),t("div",null,[s[9]||(s[9]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"评估提示词",-1)),t("div",ft,i(l.value.evaluation_context.evaluation_prompt||"暂无评估提示词"),1)])])])])])):r("",!0),y.value==="results"?(o(),e("div",ht,[s[18]||(s[18]=t("h3",{class:"text-lg font-medium text-gray-900"},"评估结果详情",-1)),t("div",wt,[t("div",kt,[t("div",jt,[s[11]||(s[11]=t("h4",{class:"text-lg font-medium text-gray-800"},"记忆重要性评分",-1)),t("div",Dt,i(l.value.evaluation_results.importance_score||0)+"/10 ",1)]),t("div",$t,[t("div",Ct,[t("div",{class:"bg-gradient-to-r from-blue-500 to-blue-600 h-3 rounded-full transition-all duration-500",style:P({width:`${(l.value.evaluation_results.importance_score||0)*10}%`})},null,4)])]),t("div",null,[s[12]||(s[12]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"评分理由",-1)),t("div",It,i(l.value.evaluation_results.importance_reason||"暂无评分理由"),1)])]),t("div",Et,[s[13]||(s[13]=t("h4",{class:"font-medium text-gray-800 mb-3"},"情感分析",-1)),l.value.evaluation_results.emotion_analysis&&Object.keys(l.value.evaluation_results.emotion_analysis).length?(o(),e("div",Vt,[t("div",Ft,[(o(!0),e(c,null,v(l.value.evaluation_results.emotion_analysis,(a,d)=>(o(),e("div",{key:d,class:"text-center"},[t("div",At,i(A(d)),1),t("div",St,i(d),1),t("div",Nt,i((a*100).toFixed(1))+"%",1)]))),128))])])):(o(),e("div",Tt," 暂无情感分析数据 "))]),t("div",null,[s[14]||(s[14]=t("h4",{class:"font-medium text-gray-800 mb-3"},"主题标签",-1)),t("div",zt,[(o(!0),e(c,null,v(l.value.evaluation_results.topic_tags,a=>(o(),e("span",{key:a,class:"px-3 py-1 bg-green-100 text-green-800 text-sm rounded-full border border-green-200"}," #"+i(a),1))),128)),(f=l.value.evaluation_results.topic_tags)!=null&&f.length?r("",!0):(o(),e("span",Bt," 暂无主题标签 "))])]),t("div",null,[s[15]||(s[15]=t("h4",{class:"font-medium text-gray-800 mb-3"},"知识提取",-1)),t("div",Mt,[(o(!0),e(c,null,v(l.value.evaluation_results.knowledge_extracted,(a,d)=>(o(),e("div",{key:d,class:"p-3 bg-yellow-50 rounded-md border border-yellow-200 text-sm"},[t("div",Pt,[t("div",Ht,i(d+1),1),t("div",null,i(a),1)])]))),128)),($=l.value.evaluation_results.knowledge_extracted)!=null&&$.length?r("",!0):(o(),e("div",Kt," 暂无提取的知识 "))])]),t("div",null,[s[17]||(s[17]=t("h4",{class:"font-medium text-gray-800 mb-3"},"关联建议",-1)),t("div",Lt,[(o(!0),e(c,null,v(l.value.evaluation_results.association_suggestions,(a,d)=>(o(),e("div",{key:d,class:"p-3 bg-indigo-50 rounded-md border border-indigo-200 text-sm"},[t("div",Ot,[s[16]||(s[16]=t("div",{class:"w-5 h-5 bg-indigo-500 rounded-full flex items-center justify-center text-white text-xs font-bold flex-shrink-0 mt-0.5"}," 💡 ",-1)),t("div",null,i(a),1)])]))),128)),(C=l.value.evaluation_results.association_suggestions)!=null&&C.length?r("",!0):(o(),e("div",Ut," 暂无关联建议 "))])])])])):r("",!0),y.value==="associations"?(o(),e("div",qt,[s[27]||(s[27]=t("h3",{class:"text-lg font-medium text-gray-900"},"自动关联创建",-1)),t("div",Gt,[t("div",Jt,[t("div",Qt,[s[19]||(s[19]=t("div",{class:"text-sm text-gray-600"},"新建关联数",-1)),t("div",Rt,i(l.value.association_creation.association_count||0),1)]),t("div",Wt,[s[20]||(s[20]=t("div",{class:"text-sm text-gray-600"},"关联类型数",-1)),t("div",Xt,i(((I=l.value.association_creation.association_types)==null?void 0:I.length)||0),1)]),t("div",Yt,[s[21]||(s[21]=t("div",{class:"text-sm text-gray-600"},"创建耗时",-1)),t("div",Zt,i(j(l.value.association_creation.creation_time)),1)])]),(E=l.value.association_creation.association_types)!=null&&E.length?(o(),e("div",ts,[s[22]||(s[22]=t("h4",{class:"font-medium text-gray-800 mb-3"},"关联类型",-1)),t("div",ss,[(o(!0),e(c,null,v(l.value.association_creation.association_types,a=>(o(),e("span",{key:a,class:"px-3 py-1 bg-orange-100 text-orange-800 text-sm rounded-full border border-orange-200"},i(a),1))),128))])])):r("",!0),t("div",null,[s[26]||(s[26]=t("h4",{class:"font-medium text-gray-800 mb-3"},"新建关联",-1)),t("div",es,[(o(!0),e(c,null,v(l.value.association_creation.new_associations,(a,d)=>(o(),e("div",{key:d,class:"p-4 bg-white border border-gray-200 rounded-lg"},[t("div",os,[t("span",ls,"关联 #"+i(d+1),1),t("span",as,i(a.type||"未知类型"),1)]),t("div",is,[t("div",null,[s[23]||(s[23]=t("strong",null,"源:",-1)),w(" "+i(a.source||"未知"),1)]),t("div",null,[s[24]||(s[24]=t("strong",null,"目标:",-1)),w(" "+i(a.target||"未知"),1)]),a.strength?(o(),e("div",ns,[s[25]||(s[25]=t("strong",null,"强度:",-1)),w(" "+i((a.strength*100).toFixed(1))+"%",1)])):r("",!0)])]))),128)),(V=l.value.association_creation.new_associations)!=null&&V.length?r("",!0):(o(),e("div",ds," 暂无新建关联 "))])])])])):r("",!0)])])])):_.value?r("",!0):(o(),e("div",rs,[u(x(U),{class:"w-16 h-16 mx-auto mb-4 text-gray-400"}),s[28]||(s[28]=t("h2",{class:"text-xl font-semibold text-gray-700 mb-2"},"选择一个会话查看评估结果",-1)),s[29]||(s[29]=t("p",{class:"text-gray-600 mb-6"}," 输入会话ID查看完整的异步评估过程和结果 ",-1))]))]),h.value?(o(),e("div",us,[t("div",{class:"fixed inset-0 bg-black/50 backdrop-blur-sm",onClick:s[1]||(s[1]=a=>h.value=!1)}),t("div",cs,[t("div",vs,[t("div",xs,[t("div",ms,[s[31]||(s[31]=t("h3",{class:"text-lg font-semibold text-gray-900"},"异步评估展示 - 功能预览",-1)),t("button",{onClick:s[2]||(s[2]=a=>h.value=!1),class:"text-gray-400 hover:text-gray-600"},[u(x(H),{class:"w-6 h-6"})])]),t("div",gs,[t("div",ps,[s[37]||(s[37]=t("h4",{class:"font-medium text-gray-800"},"核心功能",-1)),t("ul",_s,[t("li",ys,[u(x(b),{class:"w-4 h-4 text-green-500"}),s[32]||(s[32]=t("span",null,"评估触发条件监控",-1))]),t("li",bs,[u(x(b),{class:"w-4 h-4 text-green-500"}),s[33]||(s[33]=t("span",null,"评估上下文构建展示",-1))]),t("li",fs,[u(x(b),{class:"w-4 h-4 text-green-500"}),s[34]||(s[34]=t("span",null,"评估结果详情",-1))]),t("li",hs,[u(x(b),{class:"w-4 h-4 text-green-500"}),s[35]||(s[35]=t("span",null,"自动关联创建",-1))]),t("li",ws,[u(x(b),{class:"w-4 h-4 text-green-500"}),s[36]||(s[36]=t("span",null,"评估历史记录",-1))])])]),s[38]||(s[38]=K('<div class="space-y-4"><h4 class="font-medium text-gray-800">预计开发时间</h4><div class="text-sm text-gray-600 space-y-2"><div class="flex justify-between"><span>后端API扩展</span><span>2-3天</span></div><div class="flex justify-between"><span>前端组件开发</span><span>2-3天</span></div><div class="flex justify-between"><span>实时数据展示</span><span>1-2天</span></div><div class="flex justify-between border-t pt-2 font-medium"><span>总计</span><span>5-8天</span></div></div></div>',1))])])])])])):r("",!0)])}}});export{Es as default};
//# sourceMappingURL=EvaluationViewer-DBKVMq9J.js.map
